# MDebook チュートリアル

このチュートリアルでは、ブラウザベースのMarkdown電子書籍エディタ「MDebook」の基本的な使い方を説明します。

**👉 [MDebookを起動](https://fukuyori.github.io/mdebook/dist/mdebook.html)**

## 目次

1. [はじめに](#はじめに)
2. [エディタの基本](#エディタの基本)
3. [VIMモード](#vimモード)
4. [ファイル管理](#ファイル管理)
5. [画像の操作](#画像の操作)
6. [インポート・エクスポート](#インポートエクスポート)
7. [プロジェクト管理](#プロジェクト管理)
8. [便利な使い方](#便利な使い方)

---

## はじめに

### MDebookを開く

**オンライン（推奨）：**
- [https://fukuyori.github.io/mdebook/dist/mdebook.html](https://fukuyori.github.io/mdebook/dist/mdebook.html) にアクセス

**オフライン：**
1. リリースページから`mdebook.html`をダウンロード
2. ブラウザでファイルを開く（Chrome、Edge、Firefox推奨）

サンプルドキュメントが表示された状態でエディタが起動します。

### インターフェース概要

```
┌─────────────────────────────────────────────────────────────┐
│  MDebook v0.3    [ツールバーアイコン]            [言語 ▼]   │
├─────────┬───────────────────────┬───────────────────────────┤
│         │                       │                           │
│ ファイル │      エディタ         │      プレビュー            │
│  タブ   │                       │                           │
│         │                       │                           │
├─────────┴───────────────────────┴───────────────────────────┤
│  [VIMモード: NORMAL]          [行:列]           [行数]       │
├─────────────────────────────────────────────────────────────┤
│  [ファイル数: N]  [文字数: N]                    [ステータス] │
└─────────────────────────────────────────────────────────────┘
```

---

## エディタの基本

### Markdownの記述

MDebookは標準Markdownと拡張機能をサポートしています：

```markdown
# 見出し1
## 見出し2

**太字** と *斜体* テキスト

- 箇条書き
- 別の項目

1. 番号付きリスト
2. 2番目の項目

> 引用

`インラインコード`

​```javascript
// シンタックスハイライト付きコードブロック
function hello() {
  console.log("こんにちは！");
}
​```

| 列1 | 列2 |
|-----|-----|
| データ1 | データ2 |

[リンク](https://example.com)

![画像](images/photo.png)

脚注参照[^1]

[^1]: 脚注の内容
```

### Mermaidダイアグラム

Mermaid記法で図を作成：

```markdown
​```mermaid
graph LR
    A[開始] --> B[処理]
    B --> C[終了]
​```
```

### ライブプレビュー

- 入力に合わせてプレビューがリアルタイム更新
- スクロール同期：エディタのスクロールがプレビューと連動（逆も同様）
- ツールバーの目のアイコンでプレビュー表示を切り替え

---

## VIMモード

MDebookは効率的な編集のためのフルVIMキーバインドを搭載しています。

### モードインジケーター

ステータスバーに現在のVIMモードが表示されます：
- **NORMAL**（青）- ナビゲーションとコマンド
- **INSERT**（緑）- テキスト入力
- **VISUAL**（紫）- テキスト選択
- **REPLACE**（赤）- 上書きモード

### 基本ナビゲーション（NORMALモード）

| キー | 動作 |
|-----|------|
| `h` | 左に移動 |
| `j` | 下に移動 |
| `k` | 上に移動 |
| `l` | 右に移動 |
| `w` | 次の単語 |
| `b` | 前の単語 |
| `0` | 行頭 |
| `$` | 行末 |
| `gg` | ファイル先頭 |
| `G` | ファイル末尾 |

### INSERTモードへの移行

| キー | 動作 |
|-----|------|
| `i` | カーソル前に挿入 |
| `a` | カーソル後に挿入 |
| `I` | 行頭に挿入 |
| `A` | 行末に挿入 |
| `o` | 下に新しい行 |
| `O` | 上に新しい行 |

### 編集コマンド

| キー | 動作 |
|-----|------|
| `dd` | 行を削除 |
| `yy` | 行をヤンク（コピー） |
| `p` | カーソル後にペースト |
| `P` | カーソル前にペースト |
| `u` | 元に戻す |
| `Ctrl+r` | やり直し |
| `x` | 文字を削除 |
| `r` | 文字を置換 |

### Exコマンド

| コマンド | 動作 |
|---------|------|
| `:w` | 保存（上書き） |
| `:w!` | ダイアログで保存 |
| `:w ファイル名` | 名前を付けて保存 |
| `:e ファイル名` | ファイルを開く/作成 |
| `:q` | ファイルを閉じる |
| `:wq` | 保存して閉じる |
| `:imp` | インポートダイアログ |
| `:imp URL` | URLからインポート |

### VIMモードを無効にする

- ツールバーの**VIM**ボタンをクリック
- または`Ctrl+\``でトグル

---

## ファイル管理

### 新規ファイルの作成

1. ファイルタブの下部にある**+**ボタンをクリック
2. またはVIMコマンドモードで`:e newfile.md`

### ファイル名の変更

1. ファイルタブをダブルクリック
2. 新しい名前を入力
3. Enterで確定（Escapeでキャンセル）

### ファイルの並び替え

- ファイルタブをドラッグ&ドロップで並び替え
- エクスポート時にこの順序が維持されます

### ファイルの削除

- ファイルタブの**×**ボタンをクリック
- 注意：最後の1つのファイルは削除できません

### ファイルのインポート

**ローカルファイルから：**
1. ツールバーのフォルダアイコンをクリック
2. または`.md`ファイルをアプリにドラッグ&ドロップ
3. 現在アクティブなタブの後に挿入されます

**URLから：**
1. `:imp URL`を使用するかフォルダアイコンをクリック
2. 対応URL：
   - Qiita記事（`.md`が自動追加）
   - GitHubファイル（rawに自動変換）
   - 直接の`.md` URL

---

## 画像の操作

### 画像の追加

**方法1：クリップボードからペースト**
1. 画像をクリップボードにコピー
2. エディタでペースト（`Ctrl+V`）
3. 画像が埋め込まれ、Markdown参照が挿入される

**方法2：ドラッグ&ドロップ**
1. 画像ファイルをエディタエリアにドラッグ
2. 画像がプロジェクトに追加される

**方法3：ファイルピッカー**
1. ツールバーの画像アイコンをクリック
2. 画像ファイルを選択

### 画像の保存

- 画像はプロジェクト内に保存されます
- `![alt](images/image-id)`として参照
- `.mdebook`として保存時に自動的に含まれる
- 参照されていない画像は手動保存時にクリーンアップ

---

## インポート・エクスポート

### エクスポート形式

**EPUB**
- 標準的な電子書籍形式
- Kindle、Apple Booksなどと互換性あり
- 表紙画像をサポート（設定パネルで設定）
- エクスポート → EPUB をクリック

**PDF**
- ブラウザの印刷ダイアログを開く
- 「PDFとして保存」オプションを使用
- エクスポート → PDF をクリック

**HTML**
- スタイル埋め込みのスタンドアロンHTMLファイル
- ダーク/ライトテーマ設定を維持
- エクスポート → HTML をクリック

**Markdown (ZIP)**
- すべての章と画像をエクスポート
- 構造：
  ```
  book-markdown.zip
  ├── metadata.json
  ├── chapters/
  │   ├── 01-chapter1.md
  │   └── 02-chapter2.md
  └── images/
      └── image.png
  ```
- エクスポート → Markdown (ZIP) をクリック

### プロジェクトのインポート

**`.mdebook`ファイルから：**
1. 開く（フォルダアイコン）をクリック
2. `.mdebook`ファイルを選択
3. またはアプリにドラッグ&ドロップ

**Markdownファイルから：**
1. インポートダイアログを使用
2. または`.md`ファイルをドラッグ&ドロップ

---

## プロジェクト管理

### プロジェクトの保存

**クイック保存（`:w`）**
- File System Access APIで開いた場合は現在のファイルを上書き
- そうでなければ保存ダイアログを開く

**ダイアログで保存（`:w!`）**
- 常に保存ダイアログを開く

**プロジェクト形式**
- `.mdebook`ファイルには以下が含まれます：
  - すべての章（Markdown）
  - 埋め込み画像
  - メタデータ（タイトル、著者、言語）
  - UI設定

### 自動保存

- セッションはIndexedDBに自動保存
- ブラウザを再度開くと復元
- 各ブラウザタブは独自のセッションを持つ

### 設定パネル

歯車アイコンをクリックしてアクセス：
- **タイトル**：本のタイトル（エクスポートで使用）
- **著者**：著者名
- **言語**：本の言語（EPUBメタデータ用）
- **表紙画像**：プロジェクト内の画像から選択（EPUB用）

---

## 便利な使い方

### キーボードショートカット

| ショートカット | 動作 |
|---------------|------|
| `Ctrl+\`` | VIMモードの切り替え |
| `Esc` | NORMALモードに戻る / ダイアログを閉じる |

### URLインポートのヒント

```
# Qiita記事
https://qiita.com/username/items/article-id

# GitHubファイル
https://github.com/user/repo/blob/main/file.md

# Raw URL
https://example.com/document.md
```

### 効率的なワークフロー

1. **アウトラインから始める**：章ごとに複数のファイルを作成
2. **自由に並び替え**：タブをドラッグして構造を整理
3. **VIMを使う**：`:w`と`:e`をマスターして素早くファイル操作
4. **頻繁にプレビュー**：プレビューを切り替えてフォーマットを確認
5. **早めにエクスポート**：問題を早期発見するためにEPUBエクスポートをテスト

### ベストプラクティス

- 説明的なファイル名を使用（エクスポートで章タイトルになります）
- 電子書籍互換性のために画像サイズを適度に保つ
- `:w`で定期的に保存
- 画像を含むプロジェクトには`.mdebook`形式を使用

---

## トラブルシューティング

### プレビューが更新されない

- プレビューが表示されているか確認（目のアイコン）
- VIMモードをオフにしてから再度オンにしてみる

### 画像が表示されない

- 画像がプロジェクト内にあることを確認（外部URLではなく）
- 画像パスの形式を確認：`![alt](images/id)`

### 保存が機能しない

- Chrome/Edge：File System Access APIで動作するはず
- Firefox/Safari：常にダウンロードダイアログが表示されます

### VIMモードの問題

- NORMALモードであることを確認するために`Esc`を複数回押す
- ステータスバーのモードインジケーターを確認

---

## ヘルプ

- [GitHub Issues](https://github.com/fukuyori/mdebook/issues)
- [README](../README.ja.md)

---

楽しい執筆を！📚
